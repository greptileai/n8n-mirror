{
	"httpRequest": {
		"method": "POST",
		"path": "/v1/messages",
		"body": {
			"contentType": "application/json",
			"type": "JSON",
			"json": {
				"model": "claude-sonnet-4-5-20250929",
				"temperature": 0,
				"stream": false,
				"max_tokens": 16000,
				"tools": [
					{
						"name": "extract",
						"description": "The complete updated parameters object for the node. Must include only parameters from <node_properties_definition>, for example For example: { \"parameters\": { \"method\": \"POST\", \"url\": \"https://api.example.com\", \"sendHeaders\": true, \"headerParameters\": { \"parameters\": [{ \"name\": \"Content-Type\", \"value\": \"application/json\" }] } } }}",
						"input_schema": {
							"type": "object",
							"properties": {
								"parameters": {
									"type": "object",
									"properties": {},
									"additionalProperties": true,
									"description": "The complete updated parameters object for the node. This should be a JSON object that matches the node's parameter structure. Include ALL existing parameters plus the requested changes."
								}
							},
							"required": ["parameters"],
							"additionalProperties": false,
							"description": "The complete updated parameters object for the node. Must include only parameters from <node_properties_definition>, for example For example: { \"parameters\": { \"method\": \"POST\", \"url\": \"https://api.example.com\", \"sendHeaders\": true, \"headerParameters\": { \"parameters\": [{ \"name\": \"Content-Type\", \"value\": \"application/json\" }] } } }}",
							"$schema": "http://json-schema.org/draft-07/schema#"
						}
					}
				],
				"tool_choice": {
					"type": "tool",
					"name": "extract"
				},
				"thinking": {
					"type": "disabled"
				},
				"messages": [
					{
						"role": "user",
						"content": [
							{
								"type": "text",
								"text": "\nThe node accepts these properties:\n<node_properties_definition>\n[\n  {\n    \"displayName\": \"This node must be connected to an AI chain. <a data-action='openSelectiveNodeCreator' data-action-parameter-creatorview='AI'>Insert one</a>\",\n    \"name\": \"notice\",\n    \"type\": \"notice\",\n    \"default\": \"\",\n    \"typeOptions\": {\n      \"containerClass\": \"ndv-connection-hint-notice\"\n    }\n  },\n  {\n    \"displayName\": \"If using JSON response format, you must include word \\\"json\\\" in the prompt in your chain or agent. Also, make sure to select latest models released post November 2023.\",\n    \"name\": \"notice\",\n    \"type\": \"notice\",\n    \"default\": \"\",\n    \"displayOptions\": {\n      \"show\": {\n        \"/options.responseFormat\": [\n          \"json_object\"\n        ]\n      }\n    }\n  },\n  {\n    \"displayName\": \"If using JSON response format, you must include word \\\"json\\\" in the prompt in your chain or agent. Also, make sure to select latest models released post November 2023.\",\n    \"name\": \"notice\",\n    \"type\": \"notice\",\n    \"default\": \"\",\n    \"displayOptions\": {\n      \"show\": {\n        \"/options.textFormat.textOptions.type\": [\n          \"json_object\"\n        ]\n      }\n    }\n  },\n  {\n    \"displayName\": \"Model\",\n    \"name\": \"model\",\n    \"type\": \"resourceLocator\",\n    \"default\": {\n      \"mode\": \"list\",\n      \"value\": \"gpt-5-mini\"\n    },\n    \"required\": true,\n    \"modes\": [\n      {\n        \"displayName\": \"From List\",\n        \"name\": \"list\",\n        \"type\": \"list\",\n        \"placeholder\": \"Select a model...\",\n        \"typeOptions\": {\n          \"searchListMethod\": \"searchModels\",\n          \"searchable\": true\n        }\n      },\n      {\n        \"displayName\": \"ID\",\n        \"name\": \"id\",\n        \"type\": \"string\",\n        \"placeholder\": \"gpt-5-mini\"\n      }\n    ],\n    \"description\": \"The model. Choose from the list, or specify an ID.\",\n    \"displayOptions\": {\n      \"hide\": {\n        \"@version\": [\n          {\n            \"_cnd\": {\n              \"lte\": 1.1\n            }\n          }\n        ]\n      }\n    }\n  },\n  {\n    \"displayName\": \"When using non-OpenAI models via \\\"Base URL\\\" override, not all models might be chat-compatible or support other features, like tools calling or JSON response format\",\n    \"name\": \"notice\",\n    \"type\": \"notice\",\n    \"default\": \"\",\n    \"displayOptions\": {\n      \"show\": {\n        \"/options.baseURL\": [\n          {\n            \"_cnd\": {\n              \"exists\": true\n            }\n          }\n        ]\n      }\n    }\n  },\n  {\n    \"displayName\": \"Use Responses API\",\n    \"name\": \"responsesApiEnabled\",\n    \"type\": \"boolean\",\n    \"default\": true,\n    \"description\": \"Whether to use the Responses API to generate the response. <a href=\\\"https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.lmchatopenai/#use-responses-api\\\">Learn more</a>.\",\n    \"displayOptions\": {\n      \"show\": {\n        \"@version\": [\n          {\n            \"_cnd\": {\n              \"gte\": 1.3\n            }\n          }\n        ]\n      }\n    }\n  },\n  {\n    \"displayName\": \"Built-in Tools\",\n    \"name\": \"builtInTools\",\n    \"placeholder\": \"Add Built-in Tool\",\n    \"type\": \"collection\",\n    \"default\": {},\n    \"options\": [\n      {\n        \"displayName\": \"Web Search\",\n        \"name\": \"webSearch\",\n        \"type\": \"collection\",\n        \"default\": {\n          \"searchContextSize\": \"medium\"\n        },\n        \"options\": [\n          {\n            \"displayName\": \"Search Context Size\",\n            \"name\": \"searchContextSize\",\n            \"type\": \"options\",\n            \"default\": \"medium\",\n            \"description\": \"High level guidance for the amount of context window space to use for the search\",\n            \"options\": [\n              {\n                \"name\": \"Low\",\n                \"value\": \"low\"\n              },\n              {\n                \"name\": \"Medium\",\n                \"value\": \"medium\"\n              },\n              {\n                \"name\": \"High\",\n                \"value\": \"high\"\n              }\n            ]\n          },\n          {\n            \"displayName\": \"Web Search Allowed Domains\",\n            \"name\": \"allowedDomains\",\n            \"type\": \"string\",\n            \"default\": \"\",\n            \"description\": \"Comma-separated list of domains to search. Only domains in this list will be searched.\",\n            \"placeholder\": \"e.g. google.com, wikipedia.org\"\n          },\n          {\n            \"displayName\": \"Country\",\n            \"name\": \"country\",\n            \"type\": \"string\",\n            \"default\": \"\",\n            \"placeholder\": \"e.g. US, GB\"\n          },\n          {\n            \"displayName\": \"City\",\n            \"name\": \"city\",\n            \"type\": \"string\",\n            \"default\": \"\",\n            \"placeholder\": \"e.g. New York, London\"\n          },\n          {\n            \"displayName\": \"Region\",\n            \"name\": \"region\",\n            \"type\": \"string\",\n            \"default\": \"\",\n            \"placeholder\": \"e.g. New York, London\"\n          }\n        ]\n      },\n      {\n        \"displayName\": \"File Search\",\n        \"name\": \"fileSearch\",\n        \"type\": \"collection\",\n        \"default\": {\n          \"vectorStoreIds\": \"[]\"\n        },\n        \"options\": [\n          {\n            \"displayName\": \"Vector Store IDs\",\n            \"name\": \"vectorStoreIds\",\n            \"description\": \"The vector store IDs to use for the file search. Vector stores are managed via OpenAI Dashboard. <a href=\\\"https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.lmchatopenai/#built-in-tools\\\">Learn more</a>.\",\n            \"type\": \"json\",\n            \"default\": \"[]\",\n            \"required\": true\n          },\n          {\n            \"displayName\": \"Filters\",\n            \"name\": \"filters\",\n            \"type\": \"json\",\n            \"default\": \"{}\"\n          },\n          {\n            \"displayName\": \"Max Results\",\n            \"name\": \"maxResults\",\n            \"type\": \"number\",\n            \"default\": 1,\n            \"typeOptions\": {\n              \"minValue\": 1,\n              \"maxValue\": 50\n            }\n          }\n        ]\n      },\n      {\n        \"displayName\": \"Code Interpreter\",\n        \"name\": \"codeInterpreter\",\n        \"type\": \"boolean\",\n        \"default\": true,\n        \"description\": \"Whether to allow the model to execute code in a sandboxed environment\"\n      }\n    ],\n    \"displayOptions\": {\n      \"show\": {\n        \"@version\": [\n          {\n            \"_cnd\": {\n              \"gte\": 1.3\n            }\n          }\n        ],\n        \"/responsesApiEnabled\": [\n          true\n        ]\n      }\n    }\n  },\n  {\n    \"displayName\": \"Options\",\n    \"name\": \"options\",\n    \"placeholder\": \"Add Option\",\n    \"description\": \"Additional options to add\",\n    \"type\": \"collection\",\n    \"default\": {},\n    \"options\": [\n      {\n        \"displayName\": \"Frequency Penalty\",\n        \"name\": \"frequencyPenalty\",\n        \"default\": 0,\n        \"typeOptions\": {\n          \"maxValue\": 2,\n          \"minValue\": -2,\n          \"numberPrecision\": 1\n        },\n        \"description\": \"Positive values penalize new tokens based on their existing frequency in the text so far, decreasing the model's likelihood to repeat the same line verbatim\",\n        \"type\": \"number\"\n      },\n      {\n        \"displayName\": \"Maximum Number of Tokens\",\n        \"name\": \"maxTokens\",\n        \"default\": -1,\n        \"description\": \"The maximum number of tokens to generate in the completion. Most models have a context length of 2048 tokens (except for the newest models, which support 32,768).\",\n        \"type\": \"number\",\n        \"typeOptions\": {\n          \"maxValue\": 32768\n        }\n      },\n      {\n        \"displayName\": \"Response Format\",\n        \"name\": \"responseFormat\",\n        \"default\": \"text\",\n        \"type\": \"options\",\n        \"options\": [\n          {\n            \"name\": \"Text\",\n            \"value\": \"text\",\n            \"description\": \"Regular text response\"\n          },\n          {\n            \"name\": \"JSON\",\n            \"value\": \"json_object\",\n            \"description\": \"Enables JSON mode, which should guarantee the message the model generates is valid JSON\"\n          }\n        ],\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              false\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Response Format\",\n        \"name\": \"textFormat\",\n        \"type\": \"fixedCollection\",\n        \"default\": {\n          \"textOptions\": [\n            {\n              \"type\": \"text\"\n            }\n          ]\n        },\n        \"options\": [\n          {\n            \"displayName\": \"Text\",\n            \"name\": \"textOptions\",\n            \"values\": [\n              {\n                \"displayName\": \"Type\",\n                \"name\": \"type\",\n                \"type\": \"options\",\n                \"default\": \"\",\n                \"options\": [\n                  {\n                    \"name\": \"Text\",\n                    \"value\": \"text\"\n                  },\n                  {\n                    \"name\": \"JSON Schema (recommended)\",\n                    \"value\": \"json_schema\"\n                  },\n                  {\n                    \"name\": \"JSON Object\",\n                    \"value\": \"json_object\"\n                  }\n                ]\n              },\n              {\n                \"displayName\": \"Verbosity\",\n                \"name\": \"verbosity\",\n                \"type\": \"options\",\n                \"default\": \"medium\",\n                \"options\": [\n                  {\n                    \"name\": \"Low\",\n                    \"value\": \"low\"\n                  },\n                  {\n                    \"name\": \"Medium\",\n                    \"value\": \"medium\"\n                  },\n                  {\n                    \"name\": \"High\",\n                    \"value\": \"high\"\n                  }\n                ]\n              },\n              {\n                \"displayName\": \"Name\",\n                \"name\": \"name\",\n                \"type\": \"string\",\n                \"default\": \"my_schema\",\n                \"description\": \"The name of the response format. Must be a-z, A-Z, 0-9, or contain underscores and dashes, with a maximum length of 64.\",\n                \"displayOptions\": {\n                  \"show\": {\n                    \"type\": [\n                      \"json_schema\"\n                    ]\n                  }\n                }\n              },\n              {\n                \"displayName\": \"All properties in the schema must be set to \\\"required\\\", when using \\\"strict\\\" mode.\",\n                \"name\": \"requiredNotice\",\n                \"type\": \"notice\",\n                \"default\": \"\",\n                \"displayOptions\": {\n                  \"show\": {\n                    \"strict\": [\n                      true\n                    ]\n                  }\n                }\n              },\n              {\n                \"displayName\": \"Schema\",\n                \"name\": \"schema\",\n                \"type\": \"json\",\n                \"default\": \"{\\n  \\\"type\\\": \\\"object\\\",\\n  \\\"properties\\\": {\\n    \\\"message\\\": {\\n      \\\"type\\\": \\\"string\\\"\\n    }\\n  },\\n  \\\"additionalProperties\\\": false,\\n  \\\"required\\\": [\\\"message\\\"]\\n}\",\n                \"description\": \"The schema of the response format\",\n                \"displayOptions\": {\n                  \"show\": {\n                    \"type\": [\n                      \"json_schema\"\n                    ]\n                  }\n                }\n              },\n              {\n                \"displayName\": \"Description\",\n                \"name\": \"description\",\n                \"type\": \"string\",\n                \"default\": \"\",\n                \"description\": \"The description of the response format\",\n                \"displayOptions\": {\n                  \"show\": {\n                    \"type\": [\n                      \"json_schema\"\n                    ]\n                  }\n                }\n              },\n              {\n                \"displayName\": \"Strict\",\n                \"name\": \"strict\",\n                \"type\": \"boolean\",\n                \"default\": false,\n                \"description\": \"Whether to require that the AI will always generate responses that match the provided JSON Schema\",\n                \"displayOptions\": {\n                  \"show\": {\n                    \"type\": [\n                      \"json_schema\"\n                    ]\n                  }\n                }\n              }\n            ]\n          }\n        ],\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              true\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Presence Penalty\",\n        \"name\": \"presencePenalty\",\n        \"default\": 0,\n        \"typeOptions\": {\n          \"maxValue\": 2,\n          \"minValue\": -2,\n          \"numberPrecision\": 1\n        },\n        \"description\": \"Positive values penalize new tokens based on whether they appear in the text so far, increasing the model's likelihood to talk about new topics\",\n        \"type\": \"number\"\n      },\n      {\n        \"displayName\": \"Sampling Temperature\",\n        \"name\": \"temperature\",\n        \"default\": 0.7,\n        \"typeOptions\": {\n          \"maxValue\": 2,\n          \"minValue\": 0,\n          \"numberPrecision\": 1\n        },\n        \"description\": \"Controls randomness: Lowering results in less random completions. As the temperature approaches zero, the model will become deterministic and repetitive.\",\n        \"type\": \"number\"\n      },\n      {\n        \"displayName\": \"Reasoning Effort\",\n        \"name\": \"reasoningEffort\",\n        \"default\": \"medium\",\n        \"description\": \"Controls the amount of reasoning tokens to use. A value of \\\"low\\\" will favor speed and economical token usage, \\\"high\\\" will favor more complete reasoning at the cost of more tokens generated and slower responses.\",\n        \"type\": \"options\",\n        \"options\": [\n          {\n            \"name\": \"Low\",\n            \"value\": \"low\",\n            \"description\": \"Favors speed and economical token usage\"\n          },\n          {\n            \"name\": \"Medium\",\n            \"value\": \"medium\",\n            \"description\": \"Balance between speed and reasoning accuracy\"\n          },\n          {\n            \"name\": \"High\",\n            \"value\": \"high\",\n            \"description\": \"Favors more complete reasoning at the cost of more tokens generated and slower responses\"\n          }\n        ],\n        \"displayOptions\": {\n          \"show\": {\n            \"/model\": [\n              {\n                \"_cnd\": {\n                  \"regex\": \"(^o1([-\\\\d]+)?$)|(^o[3-9].*)|(^gpt-5.*)\"\n                }\n              }\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Timeout\",\n        \"name\": \"timeout\",\n        \"default\": 60000,\n        \"description\": \"Maximum amount of time a request is allowed to take in milliseconds\",\n        \"type\": \"number\"\n      },\n      {\n        \"displayName\": \"Max Retries\",\n        \"name\": \"maxRetries\",\n        \"default\": 2,\n        \"description\": \"Maximum number of retries to attempt\",\n        \"type\": \"number\"\n      },\n      {\n        \"displayName\": \"Top P\",\n        \"name\": \"topP\",\n        \"default\": 1,\n        \"typeOptions\": {\n          \"maxValue\": 1,\n          \"minValue\": 0,\n          \"numberPrecision\": 1\n        },\n        \"description\": \"Controls diversity via nucleus sampling: 0.5 means half of all likelihood-weighted options are considered. We generally recommend altering this or temperature but not both.\",\n        \"type\": \"number\"\n      },\n      {\n        \"displayName\": \"Conversation ID\",\n        \"name\": \"conversationId\",\n        \"default\": \"\",\n        \"description\": \"The conversation that this response belongs to. Input items and output items from this response are automatically added to this conversation after this response completes.\",\n        \"type\": \"string\",\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              true\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Prompt Cache Key\",\n        \"name\": \"promptCacheKey\",\n        \"type\": \"string\",\n        \"default\": \"\",\n        \"description\": \"Used by OpenAI to cache responses for similar requests to optimize your cache hit rates\",\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              true\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Safety Identifier\",\n        \"name\": \"safetyIdentifier\",\n        \"type\": \"string\",\n        \"default\": \"\",\n        \"description\": \"A stable identifier used to help detect users of your application that may be violating OpenAI's usage policies. The IDs should be a string that uniquely identifies each user.\",\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              true\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Service Tier\",\n        \"name\": \"serviceTier\",\n        \"type\": \"options\",\n        \"default\": \"auto\",\n        \"description\": \"The service tier to use for the request\",\n        \"options\": [\n          {\n            \"name\": \"Auto\",\n            \"value\": \"auto\"\n          },\n          {\n            \"name\": \"Flex\",\n            \"value\": \"flex\"\n          },\n          {\n            \"name\": \"Default\",\n            \"value\": \"default\"\n          },\n          {\n            \"name\": \"Priority\",\n            \"value\": \"priority\"\n          }\n        ],\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              true\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Metadata\",\n        \"name\": \"metadata\",\n        \"type\": \"json\",\n        \"description\": \"Set of 16 key-value pairs that can be attached to an object. This can be useful for storing additional information about the object in a structured format, and querying for objects via API or the dashboard. Keys are strings with a maximum length of 64 characters. Values are strings with a maximum length of 512 characters.\",\n        \"default\": \"{}\",\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              true\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Top Logprobs\",\n        \"name\": \"topLogprobs\",\n        \"type\": \"number\",\n        \"default\": 0,\n        \"description\": \"An integer between 0 and 20 specifying the number of most likely tokens to return at each token position, each with an associated log probability\",\n        \"typeOptions\": {\n          \"minValue\": 0,\n          \"maxValue\": 20\n        },\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              true\n            ]\n          }\n        }\n      },\n      {\n        \"displayName\": \"Prompt\",\n        \"name\": \"promptConfig\",\n        \"type\": \"fixedCollection\",\n        \"description\": \"Configure the reusable prompt template configured via OpenAI Dashboard. <a href=\\\"https://platform.openai.com/docs/guides/prompt-engineering#reusable-prompts\\\">Learn more</a>.\",\n        \"default\": {\n          \"promptOptions\": [\n            {\n              \"promptId\": \"\"\n            }\n          ]\n        },\n        \"options\": [\n          {\n            \"displayName\": \"Prompt\",\n            \"name\": \"promptOptions\",\n            \"values\": [\n              {\n                \"displayName\": \"Prompt ID\",\n                \"name\": \"promptId\",\n                \"type\": \"string\",\n                \"default\": \"\",\n                \"description\": \"The unique identifier of the prompt template to use\"\n              },\n              {\n                \"displayName\": \"Version\",\n                \"name\": \"version\",\n                \"type\": \"string\",\n                \"default\": \"\",\n                \"description\": \"Optional version of the prompt template\"\n              },\n              {\n                \"displayName\": \"Variables\",\n                \"name\": \"variables\",\n                \"type\": \"json\",\n                \"default\": \"{}\",\n                \"description\": \"Variables to be substituted into the prompt template\"\n              }\n            ]\n          }\n        ],\n        \"displayOptions\": {\n          \"show\": {\n            \"@version\": [\n              {\n                \"_cnd\": {\n                  \"gte\": 1.3\n                }\n              }\n            ],\n            \"/responsesApiEnabled\": [\n              true\n            ]\n          }\n        }\n      }\n    ]\n  }\n]\n</node_properties_definition>",
								"cache_control": {
									"type": "ephemeral"
								}
							},
							{
								"type": "text",
								"text": "<instance_url>\nThe n8n instance base URL is: http://localhost:TEST_PORT\n\nThis URL is essential for webhook nodes and chat triggers as it provides the base URL for:\n- Webhook URLs that external services need to call\n- Chat trigger URLs for conversational interfaces\n- Any node that requires the full instance URL to generate proper callback URLs\n\nWhen working with webhook or chat trigger nodes, use this URL as the base for constructing proper endpoint URLs.\n</instance_url>"
							}
						]
					},
					{
						"role": "user",
						"content": "\n<current_workflow_json>\n{\"nodes\":[{\"id\":\"node-00000000\",\"name\":\"Monday Morning Trigger\",\"type\":\"n8n-nodes-base.scheduleTrigger\",\"typeVersion\":1.3,\"position\":[250,450],\"parameters\":{\"rule\":{\"interval\":[{\"field\":\"weeks\",\"weeksInterval\":1,\"triggerAtDay\":[1],\"triggerAtHour\":8,\"triggerAtMinute\":0}]}}},{\"id\":\"node-00000001\",\"name\":\"Get Weekend Emails\",\"type\":\"n8n-nodes-base.gmail\",\"typeVersion\":2.2,\"position\":[250,300],\"parameters\":{\"resource\":\"message\",\"operation\":\"getAll\",\"returnAll\":false,\"limit\":50,\"simple\":false,\"filters\":{\"receivedAfter\":\"={{ $now.minus({ days: 3 }).toISO() }}\"}},\"webhookId\":\"webhook-00000000\"},{\"id\":\"node-00000002\",\"name\":\"Combine All Emails\",\"type\":\"n8n-nodes-base.aggregate\",\"typeVersion\":1,\"position\":[250,300],\"parameters\":{\"aggregate\":\"aggregateAllItemData\",\"destinationFieldName\":\"data\",\"include\":\"allFields\"}},{\"id\":\"node-00000003\",\"name\":\"Analyze Emails for Action Items\",\"type\":\"@n8n/n8n-nodes-langchain.agent\",\"typeVersion\":3.1,\"position\":[530,300],\"parameters\":{\"hasOutputParser\":true}},{\"id\":\"node-00000004\",\"name\":\"GPT-4.1-mini Model\",\"type\":\"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\"typeVersion\":1.3,\"position\":[474,450],\"parameters\":{}},{\"id\":\"node-00000005\",\"name\":\"Structure Output Format\",\"type\":\"@n8n/n8n-nodes-langchain.outputParserStructured\",\"typeVersion\":1.3,\"position\":[474,450],\"parameters\":{\"autoFix\":false}}],\"connections\":{\"Monday Morning Trigger\":{\"main\":[[{\"node\":\"Get Weekend Emails\",\"type\":\"main\",\"index\":0}]]},\"Get Weekend Emails\":{\"main\":[[{\"node\":\"Combine All Emails\",\"type\":\"main\",\"index\":0}]]}},\"name\":\"Monday Morning Email Action Items and Priorities Summary\"}\n</current_workflow_json>\n\n<current_simplified_execution_data>\nNO EXECUTION DATA YET\n</current_simplified_execution_data>\n\n<current_execution_nodes_schemas>\nNO SCHEMA\n</current_execution_nodes_schemas>\n\n<selected_node>\nName: GPT-4.1-mini Model\nType: @n8n/n8n-nodes-langchain.lmChatOpenAi\n\nCurrent Parameters: {}\n</selected_node>\n\n<requested_changes>\n1. Set the model to 'gpt-4.1-mini' exactly as specified by the user\n</requested_changes>\n\nBased on the requested changes and the node's property definitions, return the complete updated parameters object."
					}
				],
				"system": [
					{
						"type": "text",
						"text": "<core_instructions>\nYou are an expert n8n workflow architect who updates node parameters based on natural language instructions.\n\n## Your Task\nUpdate the parameters of an existing n8n node based on the requested changes. Return the COMPLETE parameters object with both modified and unmodified parameters. Only modify the parameters that are explicitly mentioned in the changes, preserving all other existing parameters exactly as they are.\n\n## Reference Information\nYou will receive:\n1. The original user workflow request\n2. The current workflow JSON\n3. The selected node's current configuration (id, name, type, parameters)\n4. The node type's parameter definitions\n5. Natural language changes to apply\n\n## Parameter Update Guidelines\n1. START WITH CURRENT: If current parameters is empty {}, start with an empty object and add the requested parameters\n2. PRESERVE EXISTING VALUES: Only modify parameters mentioned in the requested changes\n3. MAINTAIN STRUCTURE: Keep the exact parameter structure required by the node type\n4. CHECK FOR RESOURCELOCATOR: If a parameter is type 'resourceLocator' in the node definition, it MUST use the ResourceLocator structure with __rl, mode, and value fields\n5. USE PROPER EXPRESSIONS: Follow n8n expression syntax when referencing other nodes\n6. VALIDATE TYPES: Ensure parameter values match their expected types\n7. HANDLE NESTED PARAMETERS: Correctly update nested structures like headers, conditions, etc.\n8. SIMPLE VALUES: For simple parameter updates like \"Set X to Y\", directly set the parameter without unnecessary nesting\n9. GENERATE IDS: When adding new items to arrays (like assignments, headers, etc.), generate unique IDs using a simple pattern like \"id-1\", \"id-2\", etc.\n10. TOOL NODE DETECTION: Check if node type ends with \"Tool\" to determine if $fromAI expressions are available\n11. PLACEHOLDER FORMAT: When changes specify a placeholder, copy it exactly as \"<__PLACEHOLDER_VALUE__VALUE_LABEL__>\" (no extra quotes or expressions) and keep VALUE_LABEL descriptive for the user\n</core_instructions>\n\n<expression_rules>\n\n## CRITICAL: Correctly Formatting n8n Expressions\nWhen using expressions to reference data from other nodes:\n- ALWAYS use the format: `={{ $('Node Name').item.json.field }}`\n- NEVER omit the equals sign before the double curly braces\n- ALWAYS use DOUBLE curly braces, never single\n- NEVER use emojis or special characters inside expressions as they will break the expression\n- INCORRECT: `{ $('Node Name').item.json.field }` (missing =, single braces)\n- INCORRECT: `{{ $('Node Name').item.json.field }}` (missing =)\n- INCORRECT: `={{ $('üëç Node').item.json.field }}` (contains emoji)\n- CORRECT: `={{ $('Previous Node').item.json.field }}`\n</expression_rules>\n\n<guide>\n\n## IMPORTANT: ResourceLocator Parameter Handling\n\nResourceLocator parameters are special fields used for selecting resources like Slack channels, Google Drive files, Notion pages, etc. They MUST have a specific structure:\n\n### Required ResourceLocator Structure (required fields):\n```json\n{\n  \"__rl\": true,\n  \"mode\": \"id\" | \"url\" | \"list\" | \"name\",\n  \"value\": \"the-actual-value\"\n}\n```\n\n### Mode Detection Guidelines:\n- Use the node type definition to determine the default mode and available modes for specific parameter\n- Prefer default mode from node type definition when possible\n- Switch the mode based on the input value format when necessary\n- Use mode \"list\" when the value is an ID + display name (e.g. \"Marketing Team (ID: C0122KQ70S7E)\"). Value should be set to the ID part, and cachedResultName to the display name part\n- Use mode \"url\" when the value is a URL (starts with http:// or https://)\n- Use mode \"id\" when the value looks like an ID (alphanumeric string, UUID, or other identifier)\n\nList mode structure with optional cached fields:\n```json\n{\n  \"__rl\": true,\n  \"mode\": \"list\",\n  \"value\": \"actual-id-from-list\",\n  \"cachedResultName\": \"Display Name\"\n}\n```\n\n</guide>\n\n<guide>\n\n### Referencing Output from Special Node Types\n\n#### AI Agent Output Structure\nAI Agent nodes (n8n-nodes-langchain.agent) wrap their response in an \"output\" object:\n- Without Structured Output Parser: Use `$json.output` to access the response string\n- With Structured Output Parser (hasOutputParser: true in node settings): Use `$json.output.fieldName` to access parsed fields\n- Use `$('AI Agent').item.json.output.fieldName` when referencing a node, instead of `$('AI Agent').item.json.fieldName`\n- WRONG: `$json.summary` ‚Üí CORRECT: `$json.output.summary`\n\n#### Webhook Node Output Structure\nWhen referencing data from a Webhook node (n8n-nodes-base.webhook), the incoming request is structured under `$json`:\n- `$json.headers` - HTTP headers, example: `$json.headers.authorization`\n- `$json.params` - URL path parameters, example route: `/users/:id`, access: `$json.params.id`\n- `$json.query` - Query string parameters, example URL: `?user_id=123`, access: `$json.query.user_id`\n- `$json.body` - Request payload, example JSON: `{ \"userName\": \"sam\" }`, access: `$json.body.userName`\n\nCRITICAL: When referencing data from a Webhook node, do NOT use `$json.fieldName` directly - always specify the container (body, query, params, or headers).\n</guide>\n\n<common_patterns>\n\n## Common Parameter Update Patterns\n\n### HTTP Request Node Updates\n- URL: Set directly or use expressions\n- Method: GET, POST, PUT, DELETE, etc.\n- Headers: Add/update in headerParameters.parameters array\n- Body: Update bodyParameters.parameters for POST/PUT\n- Authentication: Update authentication settings\n</common_patterns>\n\n<examples>\n\n## Examples of Parameter Updates\n\n### Example 1: Update HTTP Request URL\nChange: \"Set the URL to call the weather API for London\"\nCurrent parameters: { \"url\": \"https://api.example.com\", \"method\": \"GET\" }\nUpdated parameters: { \"url\": \"https://api.openweathermap.org/data/2.5/weather?q=London\", \"method\": \"GET\" }\n\n### Example 2: Add a header\nChange: \"Add an ABC key header with value 123\"\nCurrent parameters: { \"url\": \"...\", \"sendHeaders\": false }\nUpdated parameters: {\n  \"url\": \"...\",\n  \"sendHeaders\": true,\n  \"headerParameters\": {\n    \"parameters\": [\n      {\n        \"name\": \"ABC\",\n        \"value\": \"123\"\n      }\n    ]\n  }\n}\n\n### Example 3: Update condition\nChange: \"Check if temperature is above 25 degrees\"\nCurrent parameters: { \"conditions\": { \"conditions\": [] } }\nUpdated parameters: {\n  \"conditions\": {\n    \"options\": {\n      \"caseSensitive\": false,\n      \"leftValue\": \"\",\n      \"typeValidation\": \"loose\"\n    },\n    \"conditions\": [\n      {\n        \"leftValue\": \"={{ $('Weather Node').item.json.main.temp }}\",\n        \"rightValue\": 25,\n        \"operator\": {\n          \"type\": \"number\",\n          \"operation\": \"gt\"\n        }\n      }\n    ],\n    \"combinator\": \"and\"\n  }\n}\n\n\n### ResourceLocator Examples\n\n#### Example 1: Slack Node - Channel by ID\nCurrent Parameters:\n{\n  \"select\": \"channel\",\n  \"channelId\": {\n    \"__rl\": true,\n    \"value\": \"\",\n    \"mode\": \"list\"\n  },\n  \"otherOptions\": {}\n}\n\nRequested Changes: Send to channel C0122KQ70S7E\n\nExpected Output:\n{\n  \"select\": \"channel\",\n  \"channelId\": {\n    \"__rl\": true,\n    \"mode\": \"id\",\n    \"value\": \"C0122KQ70S7E\"\n  },\n  \"otherOptions\": {}\n}\n\n#### Example 2: Slack Node - Channel by name\nCurrent Parameters:\n{\n  \"select\": \"channel\",\n  \"channelId\": {\n    \"__rl\": true,\n    \"value\": \"\",\n    \"mode\": \"list\"\n  },\n  \"otherOptions\": {}\n}\n\nRequested Changes: Set channel to general (ID: C0A45D6GBLD)\n\nExpected Output:\n{\n  \"select\": \"channel\",\n  \"channelId\": {\n    \"__rl\": true,\n    \"mode\": \"list\",\n\t\t\"value\": \"C0A45D6GBLD\",\n\t\t\"cachedResultName\": \"general\"\n  },\n  \"otherOptions\": {}\n}\n\n#### Example 3: Google Sheets Node - Spreadsheet by name\nCurrent Parameters:\n{\n  \"operation\": \"read\",\n  \"documentId\": {\n    \"__rl\": true,\n    \"value\": \"\",\n    \"mode\": \"list\"\n  },\n  \"sheetName\": {\n    \"__rl\": true,\n    \"value\": \"\",\n    \"mode\": \"list\"\n  }\n}\n\nRequested Changes: Use the \"Sales Report 2024\" spreadsheet and \"Q1 Data\" sheet\n\nExpected Output:\n{\n  \"operation\": \"read\",\n  \"documentId\": {\n    \"__rl\": true,\n    \"mode\": \"list\",\n    \"value\": \"2wtaOwM07OTFmEijOVvzDAlxtR76hBYVBRlIwuUgDsVE\",\n    \"cachedResultName\": \"Sales Report 2024\",\n    \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/2wtaOwM07OTFmEijOVvzDAlxtR76hBYVBRlIwuUgDsVE/edit?usp=drivesdk\"\n    \n  },\n  \"sheetName\": {\n    \"__rl\": true,\n    \"mode\": \"list\",\n    \"value\": \"gid=0\",\n    \"cachedResultName\": \"Q1 Data\"\n    \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/2wtaOwM07OTFmEijOVvzDAlxtR76hBYVBRlIwuUgDsVE/edit#gid=0\"\n  }\n}\n\n#### Example 4: Google Drive Node - File by URL\nCurrent Parameters:\n{\n  \"operation\": \"download\",\n  \"fileId\": {\n    \"__rl\": true,\n    \"value\": \"\",\n    \"mode\": \"list\"\n  }\n}\n\nRequested Changes: Use file https://drive.google.com/file/d/1ABC123XYZ/view\n\nExpected Output:\n{\n  \"operation\": \"download\",\n  \"fileId\": {\n    \"__rl\": true,\n    \"mode\": \"url\",\n    \"value\": \"https://drive.google.com/file/d/1ABC123XYZ/view\"\n  }\n}\n\n#### Example 5: Notion Node - Page ID from Expression\nCurrent Parameters:\n{\n  \"resource\": \"databasePage\",\n  \"operation\": \"get\",\n  \"pageId\": {\n    \"__rl\": true,\n    \"value\": \"hardcoded-page-id\",\n    \"mode\": \"id\"\n  }\n}\n\nRequested Changes: Use page ID from the previous node's output\n\nExpected Output:\n{\n  \"resource\": \"databasePage\",\n  \"operation\": \"get\",\n  \"pageId\": {\n    \"__rl\": true,\n    \"mode\": \"id\",\n    \"value\": \"={{ $('Previous Node').item.json.pageId }}\"\n  }\n}\n\n#### Example 6: Mode Switch - From ID to List\nCurrent Parameters:\n{\n  \"operation\": \"append\",\n  \"documentId\": {\n    \"__rl\": true,\n    \"value\": \"1ABC123XYZ\",\n    \"mode\": \"id\"\n  }\n}\n\nRequested Changes: Use the \"Customer Database\" (ID: 9XYZ789DEF) spreadsheet\n\nExpected Output:\n{\n  \"operation\": \"append\",\n  \"documentId\": {\n    \"__rl\": true,\n    \"mode\": \"list\",\n    \"value\": \"9XYZ789DEF\",\n    \"cachedResultName\": \"Customer Database\"\n  }\n}\n</examples>\n\n<output_format>\n\n## Output Format\nReturn ONLY the complete updated parameters object that matches the node's parameter structure. Include ALL parameters, both modified and unmodified.\n</output_format>",
						"cache_control": {
							"type": "ephemeral"
						}
					}
				]
			}
		}
	},
	"httpResponse": {
		"statusCode": 200,
		"reasonPhrase": "OK",
		"headers": {
			"strict-transport-security": ["max-age=31536000; includeSubDomains; preload"],
			"X-Robots-Tag": ["none"],
			"Server": ["cloudflare"],
			"Content-Type": ["application/json"],
			"Content-Security-Policy": ["default-src 'none'; frame-ancestors 'none'"]
		},
		"body": {
			"contentType": "application/json",
			"type": "JSON",
			"json": {
				"model": "claude-sonnet-4-5-20250929",
				"id": "msg_01Hb4ikS3ef9kRpes6DkWkpE",
				"type": "message",
				"role": "assistant",
				"content": [
					{
						"type": "tool_use",
						"id": "toolu_01PsiirGGYWwuAYaWWgkif4T",
						"name": "extract",
						"input": {
							"parameters": {
								"model": {
									"__rl": true,
									"mode": "id",
									"value": "gpt-4.1-mini"
								}
							}
						}
					}
				],
				"stop_reason": "tool_use",
				"stop_sequence": null,
				"usage": {
					"input_tokens": 834,
					"cache_creation_input_tokens": 0,
					"cache_read_input_tokens": 9566,
					"cache_creation": {
						"ephemeral_5m_input_tokens": 0,
						"ephemeral_1h_input_tokens": 0
					},
					"output_tokens": 74,
					"service_tier": "standard"
				}
			}
		}
	},
	"id": "1770043379544-unknown-host-POST-_v1_messages-1d001a14.json",
	"priority": 0,
	"timeToLive": {
		"unlimited": true
	},
	"times": {
		"unlimited": true
	}
}
